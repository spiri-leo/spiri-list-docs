## Как создать свои фильтры

1. Как создать свои фильтры
   - [Комментария](#комментария)
   - [Блокировка домена](#блокировка-домена)
     - [Блокировка домена только одного протокола](#блокировка-домена-только-одного-протокола)
   - [Модификаторы](#модификаторы)
   - [Простые модификаторы](#простые-модификаторы)
   - [Generic модификаторы](#generic-модификаторы)
   - [Дополнительные модификаторы](#дополнительные модификаторы)
   - [Разблокировка домена](#разблокировка-домена)
   - [Блокировка CSS-элемента](#блокировка-css-элемента)
     - [CSS-селекторы](#css-селекторы)

## Внимание

Эта страница документации помогает поддерживать функцию или нет, дополнительная информация о [AdGuard](https://kb.adguard.com/ru/general/how-to-create-your-own-ad-filters).

## Комментария

```
! Комментария!
```

* Поддерживается большенство блокировщиков реклам

## Блокировка домена

```
||example.org^
```

* Поддерживается большенство блокировщиков реклам

### Блокировка домена молько одного промокола

```
|http://example.org/
```

* Поддерживается большенство блокировщиков реклам

## Модификаторы

Примеры:

```
||example.org^$script
```

чтобы добавить несколько используйте `,`:

```
||example.org^$script,third-party
```

* Поддерживается большенство блокировщиков реклам

## Простые модефикаторы

### `$domain`

Этот модификатор может блокировать `baddomain.com`, но блокировать домен только на доменах.

Например

```
||baddomain.com^$domain=example.com
```

чтобы было два домена, делайте:

```
||baddomain.com^$domain=example.com|example.org
```

чтобы заблокировать этот домен на всех доменах, используйте `~` (generic-фильтрация)

```
||baddomain.com^$domain=~example.com
```

или если вам нужны другие домены

```
||baddomain.com^$domain=~example.com|example.org
```

* Поддерживается большенство блокировщиков реклам

### `$third-party`

Внимание: В uBlock Origin вы можете добавить модификатор `$3p`, этот модификатор вряд ли будет работать в других блокировщиках рекламы. Но uBlock Origin сможет поддерживать модификатор `$third-party`.

Этот модификатор может блокировать сторонние запросы.

```
||example.com^$third-party
```

* Поддерживается большенство блокировщиков реклам

### `$popup`

Этот модификатор может блокировать и закрывать всплывающие окна.

```
||example.com^$popup
```

* Поддерживается большенство блокировщиков реклам

### `$match-case`

Определяет правило, которое применяется только к адресам с совпадающим регистром. По умолчанию регистр не учитывается.

Например:

```
*/BannerAd.gif$match-case
```

Этот код блокирует `example.com/BannerAd.gif`, а не `example.com/bannerad.gif`

* Поддерживается только AdGuard

### `$image`

Этот модификатор может блокировать картинки.

Например:

```
||example.com^$image
```

* Поддерживается большенство блокировщиков реклам

### `$stylesheet`

Этот модификатор может блокировать стили CSS.

Например:

```
||example.com^$stylesheet
```

* Поддерживается большенство блокировщиков реклам

### `$script`

Этот модификатор может блокировать скрипты (например: javascript, vbscript)

Например:

```
||example.com^$script
```

* Поддерживается большенство блокировщиков реклам

### `$object`

Этот модификатор может блокировать обьекты (например: Java, Adobe Flash)

Например:

```
||example.com^$object
```

* Поддерживается большенство блокировщиков реклам

### `$object-subrequest`

Этот модификатор может блокировать запрос, инициированный плагинами (чаще всего Flash).

```
||example.com^$object-subrequest
```

* Поддерживается большенство блокировщиков реклам

### `$font`

Этот модификатор может блокировать щрифты

```
||example.com^$font
```

* Поддерживается большенство блокировщиков реклам

### `$subdocument`

Этот модификатор может блокировать поддокументы (HTML-теги: iframe)

```
||example.com^$subdocument
```

* Поддерживается большенство блокировщиков реклам

### `$ping`

Этот модификатор может заблокировать запрос, созданный либо `navigator.sendBeacon()`, либо ссылку на атрибут `ping`.

```
||example.com^$ping
```

* Поддерживается большенство блокировщиков реклам

### '$xmlhttprequest'

Note: Вы можете использывать `$xhr` модификатор.

Этот модификатор может блокировать "XMLHttpRequest"

```
||example.com^$xmlhttprequest
```

* Поддерживается большенство блокировщиков реклам

### `$websocket`

Этот модификатор может блокировать веб-сокет.

```
||example.com^$websocket
```

* Поддерживается большенство блокировщиков реклам

### `$webrtc`

This modifier can block WebRTC

```
||example.com^$webrtc
```

Примечание. Этот модификатор означает окончание поддержки в будущем. Если вам нужно заблокировать WebRTC, используйте модификатор `$nowebrtc`.

* Поддерживается только AdGuard

### '$other`

Этот модификатор может блокировать все остальные объекты.

```
||example.com^$other
```

* Поддерживается большенство блокировщиков реклам

### `$document`

Внимание: Вы можете использовать `$doc` модификатор.

Этот модификатор блокирует страницы.

```
||example.com^$document
```

* Поддерживается большенство блокировщиков реклам

### `$elemhide`

Этот модификатор может отменить коды блокировки CSS в фильтре.

```
@@||example.com^$elemhide
```

Этот код отменяет все коды блокировки CSS для страниц на веб-сайте `example.com` и на других поддоменах.

* Поддерживается большенство блокировщиков реклам

### `$content`

Этот модификатор отключает правила фильтрации элементов HTML и заменяет правила на страницах, соответствующих правилу.

```
@@||example.com^$content
```

Этот код отменяет блокировку всех элементов HTML для страниц на веб-сайте `example.com` и на других поддоменах.

* Поддерживается только AdGuard

### `$jsinject`

Этот модификатор предотвращает добавление кода javascript на страницу. Правила Javascript будут рассмотрены ниже.

```
@@||example.com^$content
```

Этот код отменяет все правила javascript для страниц на веб-сайте `example.com` и на других поддоменах.

* Поддерживается только AdGuard

### `$urlblock`

Этот модификатор отключает блокировку всех запросов, отправленных со страниц, соответствующих этому правилу.

```
@@||example.com^$urlblock
```

Запросы, отправленные со страниц на `example.com` и всех его поддоменах, не будут заблокированы.

* Поддерживается только AdGuard

### `$extension`

Этот модификатор отключает все пользовательские сценарии на страницах, соответствующих этому правилу. Этот модификатор имеет смысл только в продуктах AdGuard, которые могут выступать в качестве хостов пользовательских скриптов (AdGuard для Windows / macOS / Android).

```
@@||example.com^$extension
```

Этот код, пользовательские скрипты не будут работать на всех страницах example.com.

* Поддерживается только AdGuard

### '$stealth'

Этот модификатор отключает модуль «Антитрекинг» для всех страниц и запросов, соответствующих этому правилу.

`@@||example.com^$stealth` - полностью отключает модуль Антитрекинг для запросов к example.com и субдоменам (кроме блокировки файлов cookie и скрытия параметров отслеживания, см. ниже).
`@@||domain.com^$script,stealth,domain=example.com` - отключает модуль Антитрекинг только для скриптовых запросов к domain.com (и поддоменам) на example.com и на всех его поддоменах.
Блокировка файлов cookie и скрытие параметров отслеживания достигается с помощью правил с `$cookie` и `$removeparam` модификаторы. Исключительные правила только с `$stealth` модификатор не даст желаемого результата. Если вы хотите полностью отключить все функции Антитрекинга для определенного домена, вам необходимо включить в правило все три модификатора: `@@||example.org^$stealth,removeparam,cookie`.

* Поддерживается только AdGuard

## Generic модификаторы

### `$generichide`

Отключает все «generic» правила элементов CSS на страницах, соответствующих правилу исключения.

`@@||example.com^generichide` - отключает «generic» CSS правила на страницах example.com и всех его поддоменах.

* Поддерживается большенство блокировщиков реклам

### `$genericblock`

Отключает все общие базовые правила на страницах, соответствующих правилу исключения.

`@@||example.com^$genericblock` - отключает «generic» базовые правила на страницах example.com и всех его поддоменов.

* Поддерживается только AdGuard

### `$specifichide`

Имеет противоположный эффект по сравнению с дженерикидом. Отключает все правила скрытия «определенных» элементов и правила CSS, но не отключает «общие» правила.

`@@||example.org^$specifichide` - отключает `example.org##.banner`, но не `##.banner`

Примечание: обратите внимание, что модификатор `$elemhide` может отключить сразу все косметические правила.

* Поддерживается большенство блокировщиков реклам

## Дополнительные модификаторы

### `$removeparam`

Этот модификатор удаляет параметры в URL.

```
||example.org^$removeparam=another
```

блокирует:

```
example.com/page/?another=2
```

Для получения дополнительной информации перейдите к этому [ccылку](https://kb.adguard.com/en/general/how-to-create-your-own-ad-filters#syntax).

* Поддерживается большенство блокировщиков реклам

### `$important`

Модификатор `$important`, применяемый к правилу, повышает его приоритет над любым другим правилом без модификатора` $important`, даже над базовыми правилами исключений.

Примеры:

1:

```
||example.org^$important
@@||example.org^
```

`||example.org^$important` - заблокирует все запросы, несмотря на правило исключения.

2:

```
||example.org^$important
@@||example.org^$important
```

Правило исключения теперь также имеет модификатор `$important`, поэтому оно будет иметь более высокий приоритет.

3:

```
||example.org^$important
@@||test.org^$document
```

Если запрос к `example.org` отправляется из домена `test.org`, правило не будет применяться, несмотря на модификатор `$important`.

* Поддерживается большенство блокировщиков реклам

### `$badfilter`

Правила с модификатором `badfilter` отключают другие базовые правила, на которые они ссылаются. Это означает, что текст отключенного правила должен совпадать с текстом правила `badfilter` (без модификатора `badfilter`).

`||example.com$badfilter` отлючает `||example.com`
`||example.com$image,badfilter` отключает `||example.com,image`
`@@||example.com$badfilter` отключает `@@||example.com`
`||example.com$domain=domain.com,badfilter` отключает `||example.com$domain=domain.com`

Правила с модификатором `$badfilter` могут отключать другие базовые правила для определенных доменов, если они удовлетворяют следующим условиям:

* Правило имеет модификатор `$domain`
* Правило не имеет отрицательного домена `~` в значении модификатора `$domain`.

В этом случае правило `$badfilter` отключит соответствующее правило для доменов, указанных как в `$badfilter`, так и в базовых правилах. Обратите внимание, что здесь также работает логика TLD с подстановочными знаками.

`/some$domain=example.com|example.org|example.io` отключен для `example.com` к `/some$domain=example.com,badfilter`
`/some$domain=example.com|example.org|example.io` отключен для `example.com` и  `example.org` к `/some$domain=example.com|example.org,badfilter`
`/some$domain=example.com|example.org` и `/some$domain=example.io` полностью отключены к `/some$domain=example.com|example.org|example.io,badfilter`
`/some$domain=example.com|example.org|example.io` полностью отключены к `/some$domain=example.*,badfilter`
`/some$domain=example.*` отключен для `example.com` и `example.org` `/some$domain=example.com|example.org,badfilter`
`/some$domain=example.com|example.org|example.io` НЕ отключен для `example.com` к `/some$domain=example.com|~example.org,badfilter` потому что значение модификатора `domain` содержит инвертированный домен

* Поддерживается большенство блокировщиков реклам

### `$empty`

Обычно заблокированный запрос в браузере выглядит как ошибка сервера. Если применяется модификатор empty, блокировщики рекламы имитируют пустой ответ сервера со статусом 200 OK.

`||example.org^$empty` - возвращает пустой ответ на все запросы к домену `example.org` и всем его поддоменам.

* Поддерживается большенство блокировщиков реклам

### `$app`

Этот модификатор ограничивает правило определенным приложением (или списком приложений). Это может быть не так критично в Windows или Mac, но на мобильных устройствах, где некоторые правила должны быть специфичными для определенных приложений для правильной работы, эта функция чрезвычайно важна.

Android - используйте название пакета приложения (например, org.example.app).
Windows - используйте имя процесса (например, chrome.exe).
Mac - используйте идентификатор пакета или имя процесса (например, com.google.Chrome).

`||baddomain.com^$app=org.example.app` - правило для блокировки запросов, соответствующих указанной маске и отправленных приложением Android `org.example.app`.
`||baddomain.com^$app=org.example.app1|org.example.app2` - аналогичное правило, но оно работает как для `org.example.app1`, так и для `org.example.app2`.

Если вы хотите, чтобы правило не применялось к данному приложению, перед именем приложения ставьте `~`.

`||baddomain.com^$app=~org.example.app` - правило, которое блокирует запросы, соответствующие заданной маске и отправленные любым приложением, кроме `org.example.app`.
`||baddomain.com^$domain=~org.example.app1|~org.example.app2` - аналогично, но есть два приложения в исключениях: `org.example.app1` и `org.example.app2`.

* Поддерживает только AdGuard для Android, Windows, Mac

К следующим модификаторам, откройте эту [страницу](https://kb.adguard.com/ru/general/how-to-create-your-own-ad-filters#redirect) следующий `$redirect`

## Разблокировка домена

Разблокировка домена

```
@@||example.com^
```

Разблокировка домена только страницой:

```
@@||example.com/thepage
```

Ращблокировка с модификаторами

Например:

```
@@||example.com^$document
```

* Поддерживается большенство блокировщиков реклам

## Блокировка CSS-злемента

Например:

```
example.com##.banner
```

* Поддерживается большенство блокировщиков реклам

### CSS-селекторы

`#banners`                       - Селектор CSS блокирует идентификатор элемента

```
blocking: <div id="banners">
```

`.banners`                       - Селектор CSS блокирует элемент классов

```
blocking: <div class="banners some other classes">
```

`#div[class="banners"]`          - Селектор CSS блокирует элемент класса

```   
blocking: <div class="banners">
```

`div[class^="advert1"]`          - Селектор CSS блокирует элемент подкласса

```
<div id="banners">
  blocking: <div class="advert1">
</div>
```

`div[class$="banners_ads"]`      - Селектор CSS блокирует атрибут, заканчивающийся строкой `banners_ads`

```
blocking: <div id="banners_ads">
   <div class="advert1">
</div>
```

`a[href^="http://example.com/"]` - Селектор CSS блокирует все ссылки, загружаемые с домена `example.com`.

```
<a href="https://example.com/advert.html">
```

`a[href="http://example.com/"]`  - Селектор CSS блокирует именно адрес `example.com`.

```
<a href="https://example.com/">
```

* Поддерживается большенство блокировщиков реклам